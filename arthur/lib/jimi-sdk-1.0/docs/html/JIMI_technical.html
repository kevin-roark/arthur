<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./JIMI_technical_files/filelist.xml">
<link rel=Edit-Time-Data href="./JIMI_technical_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Jimi technical guide</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Administrator</o:Author>
  <o:LastAuthor>Phil</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>5</o:TotalTime>
  <o:LastPrinted>1999-05-06T05:04:00Z</o:LastPrinted>
  <o:Created>1999-08-13T02:31:00Z</o:Created>
  <o:LastSaved>1999-08-13T02:31:00Z</o:LastSaved>
  <o:Pages>5</o:Pages>
  <o:Words>1431</o:Words>
  <o:Characters>8157</o:Characters>
  <o:Company> </o:Company>
  <o:Bytes>32768</o:Bytes>
  <o:Lines>67</o:Lines>
  <o:Paragraphs>16</o:Paragraphs>
  <o:CharactersWithSpaces>10017</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h3
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-bidi-font-weight:normal;}
h4
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:normal;}
h6
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:6;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:7;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:8;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:9;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1579250400;
	mso-list-type:simple;
	mso-list-template-ids:-1512664310;}
@list l0:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<h1>Jimi technical guide</h1>

<h2>Intent</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This document is intended as a guide to finding out how Jimi
works internally.<span style="mso-spacerun: yes">  </span>This is “under the
hood”, providing an overview of the internal operation of some fundamental
operations: image decoding, image encoding, image export to AWT, and a range of
supporting features.</p>

<h2>Overview of packages</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Table 1 shows an overview of the fundamental packages of
Jimi.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:5.4pt;
 border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <h3>Jimi package</h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3>Description</h3>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>Front-end classes for image I/O.</p>
  <p class=MsoNormal>Core code for managing encoders and decoders.</p>
  <p class=MsoNormal>Fundamental interfaces.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.compat<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>Adapter classes to support Jimi 1.0-style format modules.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.component<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>AWT components to support imaging, heavy- and light-
  weight versions of the JimiCanvas image rendering component.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.decoder<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>Decoder implementations.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.encoder<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>Encoder implementations.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.filters<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>ImageFilter classes.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.options<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>Options classes for managing format-specific parameters.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.raster<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>Raster-based interfaces and implementations of JimiImage.</p>
  </td>
 </tr>
 <tr style='height:9.75pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.75pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.util<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.75pt'>
  <p class=MsoNormal>Shared utility classes.</p>
  </td>
 </tr>
 <tr style='height:9.85pt'>
  <td width=228 valign=top style='width:171.0pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:9.85pt'>
  <h3><span style='font-weight:normal'>com.sun.jimi.core.vmem<o:p></o:p></span></h3>
  </td>
  <td width=345 valign=top style='width:258.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:9.85pt'>
  <p class=MsoNormal>Virtual memory paging support classes.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>An overview of image decoding</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Image decoding always begins with a call from an application
to the Jimi front-end class, which results in the creation of a
JimiReader.<span style="mso-spacerun: yes">  </span>JimiReader is the bridge
between applications and decoders, providing all access to loading an image, or
series of images, from an input source.<span style="mso-spacerun: yes"> 
</span>For the JimiReader to be initialized, three things are needed: an input
source, a decoder type, and an image back-end type.<span style="mso-spacerun:
yes">  </span>The input source is ultimately an InputStream, possibly being
derived from a filename or URL.<span style="mso-spacerun: yes">  </span>The
decoder type is a mime string, such as “image/jpeg”, which identifies the
decoder required to interpret the image.<span style="mso-spacerun: yes"> 
</span>This mime type can either be specified explicitly (setMimeType()), or it
can be derived from the contents of the input stream, a filename or URL suffix,
or a java.net.URL object.<span style="mso-spacerun: yes">  </span>The image
back-end object is represented by a JimiImageFactory object, which Jimi chooses
based on flags specified by the getImage() call, such as VIRTUAL_MEMORY or
ONE_SHOT.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>When all the initialization information has been given to
the JimiReader, JimiControl is used to get an appropriate JimiDecoderFactory
for the image format.<span style="mso-spacerun: yes">  </span>A decoder
instance is then created with the factory’s createDecoder() method, and the
JimiReader initializes the decoder to prepare for image requests.<span
style="mso-spacerun: yes">  </span>Initialization of the decoder is performed
using JimiDecoder’s initDecoding() method, which returns an
ImageSeriesDecodingController (“controller object”) which can be used to
request images from the decoder.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The decoder itself runs in a separate thread, asynchronously
processing requests made via the controller object and synchronizing at
checkpoints with the JimiReader and its clients.<span style="mso-spacerun:
yes">  </span>These checkpoints are illustrated in the following figure.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><!--[if gte vml 1]><o:wrapblock><v:shapetype id="_x0000_t75"
  coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
  filled="f" stroked="f">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="if lineDrawn pixelLineWidth 0"/>
   <v:f eqn="sum @0 1 0"/>
   <v:f eqn="sum 0 0 @1"/>
   <v:f eqn="prod @2 1 2"/>
   <v:f eqn="prod @3 21600 pixelWidth"/>
   <v:f eqn="prod @3 21600 pixelHeight"/>
   <v:f eqn="sum @0 0 1"/>
   <v:f eqn="prod @6 1 2"/>
   <v:f eqn="prod @7 21600 pixelWidth"/>
   <v:f eqn="sum @8 21600 0"/>
   <v:f eqn="prod @7 21600 pixelHeight"/>
   <v:f eqn="sum @10 21600 0"/>
  </v:formulas>
  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
  <o:lock v:ext="edit" aspectratio="t"/>
 </v:shapetype><v:shape id="_x0000_s1026" type="#_x0000_t75" style='position:absolute;
  margin-left:68.4pt;margin-top:-36pt;width:254.9pt;height:361.3pt;z-index:1'
  o:allowincell="f">
  <v:imagedata src="./JIMI_technical_files/image001.gif" o:title="decoder_states"/>
  <w:wrap type="topAndBottom"/>
 </v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=91 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=340 height=482 src="./JIMI_technical_files/image001.gif"
   v:shapes="_x0000_s1026"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
When the JimiReader has initialized the decoder, it enters the Ready_To_Decode
state, where it waits for a request for an image.<span style="mso-spacerun:
yes">  </span>When the JimiReader receives such a request via a getImage()
call, the controller object is used to have decoder create a JimiImage object
for the next available image, bringing the decoder into the Created_Image
state.<span style="mso-spacerun: yes">  </span>The decoder waits there until
pixel information is required, which is caused by using the decoder’s JimiImage
object to deliver image data to an ImageConsumer, or by calling waitFinished()
on the JimiImage itself.<span style="mso-spacerun: yes">  </span>To provide
pixels, the decoder reads image data from the input source and uses it to populate
the JimiImage object, which also sends the information to any ImageConsumers
which have registered an interest.<span style="mso-spacerun: yes">  </span>When
all data for the image has been set in the JimiImage, the decoder reaches the
Image_Completed state, a synchronization point for calls to the JimiImage’s
waitFinished() method.<span style="mso-spacerun: yes">  </span>From there, the
decoder checks whether more images are available from the input source: if so,
it enters the Ready_To_Decode state again awaiting a request for the next image,
or if there are no more images then it finishes its operation.</p>

<h2>An overview of image encoding</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Encoding in Jimi is similar to decoding, only simplified
through synchronous operation.<span style="mso-spacerun: yes">  </span>When
Jimi gets a request to save an image, it creates a JimiWriter object, which is
the sister class of JimiReader providing image saving operations.<span
style="mso-spacerun: yes">  </span>The JimiWriter is initialized with an
encoding format mime-type, an OutputStream to write to, and an image or set of
images to save.<span style="mso-spacerun: yes">  </span>With this information,
JimiWriter uses JimiControl to create an appropriate JimiEncoder object for
saving with.<span style="mso-spacerun: yes">  </span>Finally, JimiWriter’s
putImage() method is called and all images are synchronously saved to the file
using the JimiEncoder.</p>

<h2>Image production</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>How a JimiImage’s ImageProducer operates is flexible and
handled by the JimiImage implementation.<span style="mso-spacerun: yes"> 
</span>In Jimi, there is one standard implementation shared by all the
JimiRasterImage types.<span style="mso-spacerun: yes">  </span>The standard
implementation, supported by JimiRasterImageSupport, is designed to wait until
image information has actually been requested before processing the image, to
allow for optimizations such as multicasting pixel information from the decoder
between the pixel storage and the first ImageConsumer.<span
style="mso-spacerun: yes">  </span>The pixel storage is managed by subclasses
of JimiRasterImageSupport for dealing with in-memory arrays, swap file paging,
or “one-shot” storage-less operation.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>One of the key benefits of this image production model is
allowance for highly optimized image delivery.<span style="mso-spacerun: yes"> 
</span>By deferring the decoding of pixel data until there is an ImageConsumer
interested in receiving it, the pixels can be multicast from the decoder to the
pixel storage and the ImageConsumer.<span style="mso-spacerun: yes"> 
</span>The greatest speed benefit provided here is when decoders are using
one-bit-per-pixel images but sending their data in pixel-per-byte arrays.<span
style="mso-spacerun: yes">  </span>In this case, pixel data from the decoder
will need to be packed into 8 pixel bytes, and then expanded during delivery to
subsequent ImageConsumer requests.<span style="mso-spacerun: yes">  </span>By
multicasting to the first consumer, the unpacked information sent by the
decoder can sent directly without an extra pixel-unpacking step.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This production model also enables one-shot storage-less
operation.<span style="mso-spacerun: yes">  </span>This is a mode of operation
where the pixel-storage is removed, providing no persistence and simply routing
pixel data from the decoder directly to the first ImageConsumer
registered.<span style="mso-spacerun: yes">  </span>This is ideal for handling
the case when users simply want to create an Image object to display, and have
no further need for the image.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Virtual memory based images benefit similarly.<span
style="mso-spacerun: yes">  </span>The image delivery optimization adds extra
value when virtual memory is being used, because the image can be sent to the
first ImageConsumer without having to read from the swap file.<span
style="mso-spacerun: yes">  </span>As pixels are received from the decoder,
they are sent directly to the first consumer and also written into the image
swap file.<span style="mso-spacerun: yes">  </span>Only in subsequent
ImageConsumer requests will the pixel information have to be read from
secondary storage.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Because the responsibility of image production rests with
the JimiImage implementation, decoders are also able to use their own
implementations.<span style="mso-spacerun: yes">  </span>For example, a decoder
could choose to provide a JimiImage object which routes all ImageConsumer
requests back to itself, scanning the input file for the required region of
data instead of storing it in memory.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>Format-specific options</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Jimi includes support for format-specific options using the
classes in the com.sun.jimi.options package.<span style="mso-spacerun: yes"> 
</span>FormatOptionSet objects are used to represent a set of options
associated with an image, either set by a decoder from options used in the
source file, or set by an application to specify specific options for image
encoding.<span style="mso-spacerun: yes">  </span>All FormatOptionSet objects
have methods for describing the options they make available, in a
JavaBeans-like way that can be used for interactive forms.<span
style="mso-spacerun: yes">  </span>In addition to this, each format supporting
a custom option set provides a specialization of FormatOptionSet which defines
methods for programmatic option manipulation.<span style="mso-spacerun: yes"> 
</span>For instance, GIF includes methods for querying and specifying frame-delays
for animation, interlacing, whether each frame should use an independent color
map, etc.</p>

<h2>The JimiCanvas component</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Jimi includes an image-rendering component called
JimiCanvas.<span style="mso-spacerun: yes">  </span>JimiCanvas is an image
viewing component which supports a range of rendering modes, including several
types of scaling and scrolling.<span style="mso-spacerun: yes"> 
</span>JimiCanvas also handles image loading, given a filename or URL it will
load and render an image in the mode it is configured for.<span
style="mso-spacerun: yes">  </span>It also supports paging through multiple
frames of a multi-page image file.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>A useful feature of JimiCanvas is “smart-scrolling”.<span
style="mso-spacerun: yes">  </span>This is a mode of scrolling that is used to
take advantage of JimiImage’s virtual memory feature.<span style="mso-spacerun:
yes">  </span>It operates by paging only the pieces of an image which are
actually in the visible scrolling area in Image objects, and using these to
render the viewable part of the image.<span style="mso-spacerun: yes"> 
</span>As the user scrolls, the buffers are updated quickly to provide smooth
scrolling through large images using very little physical memory.</p>

<h2>Additional features</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Jimi provides some additional supporting features for
handling images beyond what has been described here.<span style="mso-spacerun:
yes">  </span>Color reduction, either to a fixed number of colors or coercion
to a standard color map, is handled for all images in Jimi.<span
style="mso-spacerun: yes">  </span>Serialization is available for all images,
be they Jimi-based or from the AWT, providing simple support for persistence
for graphics in GUI applications and JavaBeans, or seamless marshalling of
images over I/O streams for client/server systems.<span style="mso-spacerun:
yes">  </span>ImageFilter implementations for common operations such as
rotation, brightness adjustment, edge-detection, and more are also provided,
and work equally well with Jimi’s own images as well as normal AWT images.</p>

</div>

</body>

</html>
